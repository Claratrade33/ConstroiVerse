<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>ConstroiVerse — Mestre de Obra</title>
  <link rel="stylesheet" href="/static/style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body class="painel-mestre">

  <header>
    <h1>👷‍♂️ ConstroiVerse — Mestre de Obra</h1>
    <p>Controle total da sua equipe e execução</p>
  </header>

  <main>

    <!-- OBRAS ATIVAS -->
    <section class="bloco bloco-obras">
      <h2>🏗️ Minhas Obras</h2>
      <ul>
        <li onclick="carregarObra('obra001')">Obra #001 — Residência Maria</li>
        <li onclick="carregarObra('obra002')">Obra #002 — Condomínio Terra Alta</li>
      </ul>
    </section>

    <!-- EQUIPE POR OBRA -->
    <section class="bloco bloco-equipe">
      <h2>👥 Equipe da Obra</h2>
      <ul id="listaEquipe">
        <li>Selecione uma obra para visualizar a equipe</li>
      </ul>
    </section>

    <!-- TAREFAS DELEGADAS -->
    <section class="bloco bloco-tarefas">
      <h2>📋 Tarefas da Obra</h2>
      <ul id="listaTarefas">
        <li>Selecione uma obra para visualizar as tarefas</li>
      </ul>
    </section>

    <!-- AVALIAÇÃO FINAL -->
    <section class="bloco bloco-avaliacao">
      <h2>✅ Avaliar Equipe após Finalização</h2>
      <button onclick="avaliarEquipe()">📝 Avaliar Todos os Profissionais</button>
      <div id="resultadoAvaliacao">Nenhuma avaliação feita ainda.</div>
    </section>

  </main>

  <footer>
    <p>ConstroiVerse © 2025 — Obra com Mente</p>
  </footer>

  <script>
    function carregarObra(obraId) {
      const equipes = {
        obra001: [
          { nome: "João Pedreiro", tarefa: "Banheiro Social", status: "em andamento" },
          { nome: "Carlos Pintor", tarefa: "Quartos das Crianças", status: "não iniciado" }
        ],
        obra002: [
          { nome: "Márcia Eletricista", tarefa: "Infra elétrica", status: "finalizado" },
          { nome: "Roberto Encanador", tarefa: "Hidráulica", status: "em andamento" }
        ]
      };

      const equipe = equipes[obraId];
      const listaEquipe = document.getElementById("listaEquipe");
      const listaTarefas = document.getElementById("listaTarefas");
      listaEquipe.innerHTML = "";
      listaTarefas.innerHTML = "";

      equipe.forEach(p => {
        const li = document.createElement("li");
        li.innerHTML = `<strong>${p.nome}</strong> — ${p.tarefa}`;
        listaEquipe.appendChild(li);
      });

      equipe.forEach((p, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          ${p.tarefa} — ${p.status} <br>
          <button onclick="marcarStatus('${obraId}', ${i}, 'iniciado')">Iniciar</button>
          <button onclick="marcarStatus('${obraId}', ${i}, 'finalizado')">Finalizar</button>
        `;
        listaTarefas.appendChild(li);
      });
    }

    function marcarStatus(obraId, index, novoStatus) {
      alert(`✅ Tarefa ${index + 1} da ${obraId} marcada como "${novoStatus.toUpperCase()}"`);
      // Aqui salvaríamos no banco e atualizamos IA de previsão
    }

    function avaliarEquipe() {
      const msg = "⭐ Avaliações registradas para todos os profissionais da obra.\nEssas avaliações serão somadas à reputação da Vitrine.";
      document.getElementById("resultadoAvaliacao").innerText = msg;
      alert(msg);
    }
  </script>
</body>
</html>