<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>ConstroiVerse â€” Mestre de Obra</title>
  <link rel="stylesheet" href="/static/style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body class="painel-mestre">

  <header>
    <h1>ğŸ‘·â€â™‚ï¸ ConstroiVerse â€” Mestre de Obra</h1>
    <p>Controle total da sua equipe e execuÃ§Ã£o</p>
  </header>

  <main>

    <!-- OBRAS ATIVAS -->
    <section class="bloco bloco-obras">
      <h2>ğŸ—ï¸ Minhas Obras</h2>
      <ul>
        <li onclick="carregarObra('obra001')">Obra #001 â€” ResidÃªncia Maria</li>
        <li onclick="carregarObra('obra002')">Obra #002 â€” CondomÃ­nio Terra Alta</li>
      </ul>
    </section>

    <!-- EQUIPE POR OBRA -->
    <section class="bloco bloco-equipe">
      <h2>ğŸ‘¥ Equipe da Obra</h2>
      <ul id="listaEquipe">
        <li>Selecione uma obra para visualizar a equipe</li>
      </ul>
    </section>

    <!-- TAREFAS DELEGADAS -->
    <section class="bloco bloco-tarefas">
      <h2>ğŸ“‹ Tarefas da Obra</h2>
      <ul id="listaTarefas">
        <li>Selecione uma obra para visualizar as tarefas</li>
      </ul>
    </section>

    <!-- AVALIAÃ‡ÃƒO FINAL -->
    <section class="bloco bloco-avaliacao">
      <h2>âœ… Avaliar Equipe apÃ³s FinalizaÃ§Ã£o</h2>
      <button onclick="avaliarEquipe()">ğŸ“ Avaliar Todos os Profissionais</button>
      <div id="resultadoAvaliacao">Nenhuma avaliaÃ§Ã£o feita ainda.</div>
    </section>

  </main>

  <footer>
    <p>ConstroiVerse Â© 2025 â€” Obra com Mente</p>
  </footer>

  <script>
    function carregarObra(obraId) {
      const equipes = {
        obra001: [
          { nome: "JoÃ£o Pedreiro", tarefa: "Banheiro Social", status: "em andamento" },
          { nome: "Carlos Pintor", tarefa: "Quartos das CrianÃ§as", status: "nÃ£o iniciado" }
        ],
        obra002: [
          { nome: "MÃ¡rcia Eletricista", tarefa: "Infra elÃ©trica", status: "finalizado" },
          { nome: "Roberto Encanador", tarefa: "HidrÃ¡ulica", status: "em andamento" }
        ]
      };

      const equipe = equipes[obraId];
      const listaEquipe = document.getElementById("listaEquipe");
      const listaTarefas = document.getElementById("listaTarefas");
      listaEquipe.innerHTML = "";
      listaTarefas.innerHTML = "";

      equipe.forEach(p => {
        const li = document.createElement("li");
        li.innerHTML = `<strong>${p.nome}</strong> â€” ${p.tarefa}`;
        listaEquipe.appendChild(li);
      });

      equipe.forEach((p, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          ${p.tarefa} â€” ${p.status} <br>
          <button onclick="marcarStatus('${obraId}', ${i}, 'iniciado')">Iniciar</button>
          <button onclick="marcarStatus('${obraId}', ${i}, 'finalizado')">Finalizar</button>
        `;
        listaTarefas.appendChild(li);
      });
    }

    function marcarStatus(obraId, index, novoStatus) {
      alert(`âœ… Tarefa ${index + 1} da ${obraId} marcada como "${novoStatus.toUpperCase()}"`);
      // Aqui salvarÃ­amos no banco e atualizamos IA de previsÃ£o
    }

    function avaliarEquipe() {
      const msg = "â­ AvaliaÃ§Ãµes registradas para todos os profissionais da obra.\nEssas avaliaÃ§Ãµes serÃ£o somadas Ã  reputaÃ§Ã£o da Vitrine.";
      document.getElementById("resultadoAvaliacao").innerText = msg;
      alert(msg);
    }
  </script>
</body>
</html>